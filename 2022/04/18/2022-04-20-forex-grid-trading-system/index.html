<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="mask-icon" href="/images/favicon.png" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"mikelhsia.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Grid trading strategy is famous for its simplicity and ease of execution, and you don’t even have to guess where the market is going. No technical analysis and indicators are needed or recogn">
<meta property="og:type" content="article">
<meta property="og:title" content="Looking for no-loss trading strategy? Here&#39;s the strategy that you should look at.">
<meta property="og:url" content="http://mikelhsia.github.io/2022/04/18/2022-04-20-forex-grid-trading-system/index.html">
<meta property="og:site_name" content="Michael&#39;s blog">
<meta property="og:description" content="Grid trading strategy is famous for its simplicity and ease of execution, and you don’t even have to guess where the market is going. No technical analysis and indicators are needed or recogn">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://mikelhsia.github.io/2022/04/18/2022-04-20-forex-grid-trading-system/grid_system.png">
<meta property="og:image" content="http://mikelhsia.github.io/2022/04/18/2022-04-20-forex-grid-trading-system/exchange.png">
<meta property="og:image" content="http://mikelhsia.github.io/2022/04/18/2022-04-20-forex-grid-trading-system/Forex_trading.png">
<meta property="og:image" content="http://mikelhsia.github.io/2022/04/18/2022-04-20-forex-grid-trading-system/grid_system.png">
<meta property="og:image" content="http://mikelhsia.github.io/2022/04/18/2022-04-20-forex-grid-trading-system/desire_trend.png">
<meta property="og:image" content="http://mikelhsia.github.io/2022/04/18/2022-04-20-forex-grid-trading-system/system_detail.png">
<meta property="og:image" content="http://mikelhsia.github.io/2022/04/18/2022-04-20-forex-grid-trading-system/std_vs_atr.png">
<meta property="og:image" content="http://mikelhsia.github.io/2022/04/18/2022-04-20-forex-grid-trading-system/ave_vs_dou.png">
<meta property="og:image" content="http://mikelhsia.github.io/2022/04/18/2022-04-20-forex-grid-trading-system/stoploss.png">
<meta property="og:image" content="http://mikelhsia.github.io/2022/04/18/2022-04-20-forex-grid-trading-system/stoploss_mdd.png">
<meta property="article:published_time" content="2022-04-18T04:03:36.000Z">
<meta property="article:modified_time" content="2022-04-21T07:47:00.621Z">
<meta property="article:author" content="Michael Hsia">
<meta property="article:tag" content="Backtesting">
<meta property="article:tag" content="Grid trading">
<meta property="article:tag" content="Forex">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://mikelhsia.github.io/2022/04/18/2022-04-20-forex-grid-trading-system/grid_system.png">

<link rel="canonical" href="http://mikelhsia.github.io/2022/04/18/2022-04-20-forex-grid-trading-system/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Looking for no-loss trading strategy? Here's the strategy that you should look at. | Michael's blog</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-177399736-1"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-177399736-1');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Michael's blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Michael's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Life-long Learning</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://mikelhsia.github.io/2022/04/18/2022-04-20-forex-grid-trading-system/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Michael Hsia">
      <meta itemprop="description" content="Free your potential with learning for the rest of your life">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Michael's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Looking for no-loss trading strategy? Here's the strategy that you should look at.
        </h1>

        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-04-18 12:03:36" itemprop="dateCreated datePublished" datetime="2022-04-18T12:03:36+08:00">2022-04-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-04-21 15:47:00" itemprop="dateModified" datetime="2022-04-21T15:47:00+08:00">2022-04-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Quantitative-Trading/" itemprop="url" rel="index"><span itemprop="name">Quantitative Trading</span></a>
                </span>
            </span>

          
            <span id="/2022/04/18/2022-04-20-forex-grid-trading-system/" class="post-meta-item leancloud_visitors" data-flag-title="Looking for no-loss trading strategy? Here's the strategy that you should look at." title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2022/04/18/2022-04-20-forex-grid-trading-system/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/04/18/2022-04-20-forex-grid-trading-system/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <img data-src="/2022/04/18/2022-04-20-forex-grid-trading-system/grid_system.png" class="" width="600">
<p style="font-size: 0.8em; text-align:center; color: grey;">
    <i></i>
</p>

<p>Grid trading strategy is famous for its simplicity and ease of execution, and you don’t even have to guess where the market is going. No technical analysis and indicators are needed or recognize any patterns among endless candlesticks. It was once known as the <em>‘no-loss strategy’</em>.</p>
<p>But, is this true that there is a strategy that causes you no risk?</p>
<p>Today we’re going to look at what grid trading strategy is about, and we will conduct a series of backtesting against the Forex market to see whether it is the holy grail of our trading strategies.</p>
<a id="more"></a>
<hr>
<h1 id="Talking"><a href="#Talking" class="headerlink" title="Talking"></a>Talking</h1><h2 id="Forex-FX-and-Forex-trading"><a href="#Forex-FX-and-Forex-trading" class="headerlink" title="Forex (FX) and Forex trading"></a>Forex (FX) and Forex trading</h2><p><strong>Forex (FX)</strong> is short for Foreign Exchange, which is the global electronic marketplace for proprietary institutions or public companies/individuals to trade international currencies and currency derivatives. Prior to the Internet age, trading in the forex market is exclusive to large financial institutions, corporations, central banks, hedge funds, and extremely wealthy individuals as the information isn’t public and timely enough for the rest of the people. Once the internet emerged, the availability of the information empowers any individual to trade the foreign currency at a fair price whenever they need to. For example, if you’re living in the UK and you would like to buy a piece of furniture from the states, you want the furniture to be received in China and then pay the money to the US dealers. Hence, you need to convert your GBP to USD on the Forex market so that you can pay USD to the US dealers.</p>
<img data-src="/2022/04/18/2022-04-20-forex-grid-trading-system/exchange.png" class="" width="600">
<p style="font-size: 0.8em; text-align:center; color: grey;">
    <i>Ill. I. International tradings require foreign currency exchange</i>
</p>

<p>There are a few things that the Forex market differs from the stock markets:</p>
<ol>
<li>Forex opens 24/7, therefore the exchange rate changes even during weekends.</li>
<li>The Forex brokerages open only within a specific timeframe, meaning your investment could variate drastically and you cannot do anything about it if you own the overnight positions.</li>
<li>The currencies traded on the market in pairs, such as EUR/USD, AUD/JPY, GBP/CAD, …. For example, EUR/USD’s current quote is at 1.0791, meaning you would be able to buy 1 Euro with 1.0791 USD.</li>
<li>As the Forex rate volatility is relatively way smaller than the equity stocks, most of the Forex agencies provide a leveraged account that allows you to play leveraged trade in the Forex market.</li>
</ol>
<p>As the example illustrated above, there will be people or institutions who demand specific currencies to fulfill their personal or business needs. Therefore, as an individual investor, you are able to offer your capital there with an exchange rate $r_{Today}$ for anyone who needs your capital. By the time you need your capital back into your pocket, you then go to the market and recall your investment with the exchange rate $r_{Later}$. What’s in for you? When the invested currency goes higher, you will be able to earn the difference between $r_{Today}$ and $r_{Later}$ while converting that currency back to the currency you own. The loss would also incur if the exchange rate goes in the opposite direction.</p>
<p>That being said, trading foreign exchange is actually pretty similar to trading equity in the stock market. You always try to buy low and sell high.</p>
<img data-src="/2022/04/18/2022-04-20-forex-grid-trading-system/Forex_trading.png" class="" width="600">
<p style="font-size: 0.8em; text-align:center; color: grey;">
    <i>Ill. II. The historical candlesticks diagram of GBP/CHF</i>
</p>

<h2 id="Forex-grid-trading-strategy"><a href="#Forex-grid-trading-strategy" class="headerlink" title="Forex grid trading strategy"></a>Forex grid trading strategy</h2><p>The grid trading system’s central idea is to build a <em>“price grid”</em> around the reference quote price, usually yesterday’s close price, and buy (long/short) when the price trigger one of the bars in your grid and closes the position when you have gained a small piece of the profit. You trade like that when the price moves up and down over and over again. In the end, you’ll be able to accumulate small pieces into a big chunk of profit. This essentially is an extended version of the <em>“mean-reversion trading strategy”</em>. <a target="_blank" rel="noopener" href="https://quantpedia.com/">Quantpedia</a> has a very nice piece to articulate what a grid trading system is about <a target="_blank" rel="noopener" href="https://quantpedia.com/a-primer-on-grid-trading-strategy/">here</a>.</p>
<p>Let’s visualize the grid trading system so that it’s easier to understand:</p>
<img data-src="/2022/04/18/2022-04-20-forex-grid-trading-system/grid_system.png" class="" width="600">
<p style="font-size: 0.8em; text-align:center; color: grey;">
    <i>Ill. III. The grid trading system</i>
</p>

<p>The above trading system deploys three bars above the reference price and three below. Each bar has the same distance from the other. If the price first goes bearish and hit the bottom of the day, by that time we will have already three long positions purchased at prices <em>b1, b2, and b3</em>. Once the market starts reversing and the price goes above the reference price bar, three orders will be sold at prices <em>s1, s2, and s3</em> respectively. In this case, you will make $\text{(s1-b1) + (s2-b2) + (s3-b3)}$ as your total return.</p>
<p>The uptrend continues, you’ll build another three short positions <em>b’1, b’2, and b’3</em> when the price reaches today’s high. These three positions will be closed when the price drop below the reference price.</p>
<p>I believe you now get the idea. The two essential ideas of this trading strategy are:</p>
<ol>
<li>The more fluctuation in price, the more we profit.</li>
<li>The average price should stay relatively stable without soaring or plummeting too fast.</li>
</ol>
<p>The below chart is extracted from one of my backtest, and it perfectly illustrates what kind of trend we’re looking for to profit from implementing the grid trading strategy.<br><img data-src="/2022/04/18/2022-04-20-forex-grid-trading-system/desire_trend.png" class="" width="600"></p>
<p style="font-size: 0.8em; text-align:center; color: grey;">
    <i>Ill. IV. The grid trading system</i>
</p>

<p>Most people believe the foreign exchange market is the best place that fit the two conditions we describe above. That’s why we’re going to backtest the grid trading strategy using Forex. Also, since the rules are relatively clear and simple, that makes the grid trading strategy is the best candidate to run/trade automatically with several of the conditions in place beforehand.</p>
<hr>
<h1 id="Doing"><a href="#Doing" class="headerlink" title="Doing"></a>Doing</h1><h2 id="Strategy-implementation"><a href="#Strategy-implementation" class="headerlink" title="Strategy implementation"></a>Strategy implementation</h2><h3 id="Strategy-setups-for-our-backtests"><a href="#Strategy-setups-for-our-backtests" class="headerlink" title="Strategy setups for our backtests"></a>Strategy setups for our backtests</h3><p>Let’s first start with identifying the parameters we need in this strategy:</p>
<ul>
<li><strong>Reference price</strong><ul>
<li>We use the close price before the previous market closed.</li>
</ul>
</li>
<li><strong>Grid number</strong><ul>
<li>10 bars above the reference price bar, and 10 bars below the reference price bar</li>
</ul>
</li>
<li><strong>Grid range</strong><ul>
<li>Grid range indicates the price range that we’re monitoring. We deploy the 20 bars across this price range. Therefore, setting a proper range would be critical to the system. If you have a pretty wide gap between bars, you’ll get fewer triggers when the price moves. On the contrary, if you have a fairly narrow gap, the price could easily penetrate your grid range and never fall back to where it was, causing a huge cost to your portfolio.</li>
<li>Here we use 2 times the standard deviation of the close price in the past three months as our grid range.</li>
</ul>
</li>
<li><strong>Leverage ratio</strong><ul>
<li>Most of the Forex brokerages offer N<em> leveraged accounts, meaning you’ll be able to deposit 1 dollar in your account and invest 1 </em> N dollars in the Forex market. For example, <a target="_blank" rel="noopener" href="https://www.oanda.com/apply/?lang=zh-tw">Oanda</a> offers 100x leveraged account type to premium customers. In this example, let’s set it to 50x for now.</li>
</ul>
</li>
<li><strong>Position allocation</strong><ul>
<li>We have set up two different methods to allocate your assets in each bar:<ul>
<li><strong>Average</strong>: We allocate the same amount of capital to each order on every bar.</li>
<li><strong>Double down</strong>: As the current quote price goes further away from the reference price, we double down the amount of the position in each order. Let’s take <strong><em>Ill. III. The grid trading system</em></strong> for example, in limit order b1 and b’1, we placed 1 hand, in b2 and b’2 we place 2 hands, and in b3 and b’3 we place 4 hands. [1, 2, 4, 8, 16, ….]</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="Platform"><a href="#Platform" class="headerlink" title="Platform"></a>Platform</h3><p><a target="_blank" rel="noopener" href="https://www.quantconnect.com/">QuantConnect</a></p>
<h3 id="Universe"><a href="#Universe" class="headerlink" title="Universe"></a>Universe</h3><p>I’m not going to use the concept of the <code>universe</code> in the backtesting of this strategy. Instead, I’m going to backtest the following foreign currency pair to see which currency pair best fits the nature of the grid trading strategy.</p>
<ul>
<li>GBP/CHF</li>
<li>AUD/CAD</li>
<li>GBP/CAD</li>
<li>USD/JPY</li>
<li>AUD/JPY</li>
<li>EUR/GBP</li>
<li>GBP/USD</li>
</ul>
<h3 id="Backtest-time-frame"><a href="#Backtest-time-frame" class="headerlink" title="Backtest time frame"></a>Backtest time frame</h3><p><strong>Backtest Date:</strong> <code>2021, 1 ,1</code> ~ <code>2022, 4, 16</code></p>
<h3 id="Signal-generation"><a href="#Signal-generation" class="headerlink" title="Signal generation"></a>Signal generation</h3><p>The triggering signal is very straightforward. As I mentioned in the <strong>Forex grid trading strategy</strong> section, the long/short limit order will be automatically triggered when the current close price touches the grid bar. However, in order to simplify the logic and to make everything automated so that the order can be generated in a timely manner, I’ve added my own tweaks to this grid trading system.</p>
<p>Referring to chart in <strong><em>Ill. III. The grid trading system</em></strong>, we see [b1, s1], [b2, s2], …, [b’1, s’1], [b’2, s’2], … as order pair. The first one in the pair is the long/short limit orders that we will place before the market starts. As long as any of the limit orders is fulfilled, the second one in the pair will be automatically triggered and generate another limit order waiting to close that position in order to gain profit. Vice versa, the fulfillment of the second limit order in the pair will also trigger the system to generate another open limit order waiting to catch the next opportunity. By doing this, we just need to set up 10 pairs of these on the long side and 10 pairs of these on the short side. See the following image for a quick illustration.</p>
<img data-src="/2022/04/18/2022-04-20-forex-grid-trading-system/system_detail.png" class="" width="600">
<p style="font-size: 0.8em; text-align:center; color: grey;">
    <i>Ill. V. The grid trading system - system detail</i>
</p>

<p>On the monthly basis, we will create 20 pairs of these to catch any movement. By the end of the month, we cancel all these open orders and close all the positions we hold. Then the next day before the market open, we readjust our reference price and recalculate the standard deviation of the past 90 days again as our grid range. By doing this, we’re going to make sure the current price won’t drift too far away from our grid if there’s a bull or bear market in the currency we’re trading against.</p>
<p>Stop-loss control is also a crucial part to be installed in every trading system. I’m placing three different scenarios of stop loss to see how they work out:</p>
<ul>
<li><strong>Don’t stop loss at all</strong>: <code>Let the profit fly</code>. We don’t set up any stop-loss point.</li>
<li><strong>Normal top loss</strong>: We monitor the distance between the current price and the reference price. If the current price deviates away from the reference price by over 20%, then we can reckon that there’s either an uptrend or downtrend that happens, which could cause a huge loss to our portfolio. If this happens, we liquidate all holding positions and close the rest of the opening limit orders. We’re not going to do any trade that month.</li>
<li><strong>Stop loss and rescale</strong>: In this scenario, right after we liquidate all existing positions and cancel open orders, we readjust all the parameters, including reference price and grid range, and deploy the grid again using the updated parameters instead of ceasing all the trading activities. We hope doing this would help us capture the new opportunities as soon as possible after the momentum of price rising/dropping ends.</li>
</ul>
<h2 id="Backtest-result"><a href="#Backtest-result" class="headerlink" title="Backtest result"></a>Backtest result</h2><div class="table-container">
<table>
<thead>
<tr>
<th><strong>Currency</strong></th>
<th><strong>Level_method</strong></th>
<th><strong>Vol_method</strong></th>
<th><strong>Stop_loss</strong></th>
<th><strong>Rescale</strong></th>
<th><strong>Return</strong></th>
<th><strong>PSR</strong></th>
<th><strong>MDD</strong></th>
<th><strong>Total_trades</strong></th>
<th><strong>Sharpe_ratio</strong></th>
<th><strong>Win_rate</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>GBPCHF</td>
<td>average</td>
<td>STD</td>
<td>FALSE</td>
<td>FALSE</td>
<td>83.33%</td>
<td>42.549%</td>
<td>80%</td>
<td>1446</td>
<td>1.264</td>
<td>74%</td>
</tr>
<tr>
<td>GBPCHF</td>
<td>average</td>
<td>STD</td>
<td>TRUE</td>
<td>FALSE</td>
<td>18.68%</td>
<td>22.167%</td>
<td>72%</td>
<td>1104</td>
<td>0.478</td>
<td>72%</td>
</tr>
<tr>
<td>GBPCHF</td>
<td>average</td>
<td>STD</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-6.34%</td>
<td>13.999%</td>
<td>74.3%</td>
<td>1531</td>
<td>0.218</td>
<td>71%</td>
</tr>
<tr>
<td>GBPCHF</td>
<td>average</td>
<td>ATR</td>
<td>FALSE</td>
<td>FALSE</td>
<td>-76.1%</td>
<td>24.781%</td>
<td>99.5%</td>
<td>5574</td>
<td>0.856</td>
<td>71%</td>
</tr>
<tr>
<td>GBPCHF</td>
<td>average</td>
<td>ATR</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-16.05%</td>
<td>6.052%</td>
<td>39.7%</td>
<td>2087</td>
<td>-0.129</td>
<td>71%</td>
</tr>
<tr>
<td>GBPCHF</td>
<td>average</td>
<td>ATR</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-91.48%</td>
<td>0.027%</td>
<td>94.2%</td>
<td>8288</td>
<td>-0.928</td>
<td>70%</td>
</tr>
<tr>
<td>GBPCHF</td>
<td>double</td>
<td>STD</td>
<td>FALSE</td>
<td>FALSE</td>
<td>11.72%</td>
<td>24.113%</td>
<td>70.4%</td>
<td>1442</td>
<td>0.587</td>
<td>97%</td>
</tr>
<tr>
<td>GBPCHF</td>
<td>double</td>
<td>STD</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-24.58%</td>
<td>0.686%</td>
<td>35%</td>
<td>1104</td>
<td>-0.635</td>
<td>98%</td>
</tr>
<tr>
<td>GBPCHF</td>
<td>double</td>
<td>STD</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-33.25%</td>
<td>0.323%</td>
<td>43.1%</td>
<td>1531</td>
<td>-0.763</td>
<td>97%</td>
</tr>
<tr>
<td>GBPCHF</td>
<td>double</td>
<td>ATR</td>
<td>FALSE</td>
<td>FALSE</td>
<td>-61.84%</td>
<td>19.401%</td>
<td>98.6%</td>
<td>5573</td>
<td>0.477</td>
<td>94%</td>
</tr>
<tr>
<td>GBPCHF</td>
<td>double</td>
<td>ATR</td>
<td>TRUE</td>
<td>FALSE</td>
<td>11.68%</td>
<td>19.159%</td>
<td>21.1%</td>
<td>2087</td>
<td>0.38</td>
<td>96%</td>
</tr>
<tr>
<td>GBPCHF</td>
<td>double</td>
<td>ATR</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-62.32%</td>
<td>0.883%</td>
<td>96%</td>
<td>8288</td>
<td>-0.755</td>
<td>96%</td>
</tr>
<tr>
<td>AUDCAD</td>
<td>average</td>
<td>STD</td>
<td>FALSE</td>
<td>FALSE</td>
<td>16.9%</td>
<td>21.526%</td>
<td>42.4%</td>
<td>959</td>
<td>0.473</td>
<td>66%</td>
</tr>
<tr>
<td>AUDCAD</td>
<td>average</td>
<td>STD</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-24.29%</td>
<td>5.07%</td>
<td>49.1%</td>
<td>814</td>
<td>-0.187</td>
<td>68%</td>
</tr>
<tr>
<td>AUDCAD</td>
<td>average</td>
<td>STD</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-24.44%</td>
<td>5.904%</td>
<td>56.2%</td>
<td>1056</td>
<td>-0.138</td>
<td>69%</td>
</tr>
<tr>
<td>AUDCAD</td>
<td>average</td>
<td>ATR</td>
<td>FALSE</td>
<td>FALSE</td>
<td>-41.20%</td>
<td>10.311%</td>
<td>74.3%</td>
<td>4368</td>
<td>0.074</td>
<td>73%</td>
</tr>
<tr>
<td>AUDCAD</td>
<td>average</td>
<td>ATR</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-40.6%</td>
<td>0.005%</td>
<td>43.2%</td>
<td>1467</td>
<td>-1.261</td>
<td>69%</td>
</tr>
<tr>
<td>AUDCAD</td>
<td>average</td>
<td>ATR</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-78.65%</td>
<td>0.041%</td>
<td>88.9%</td>
<td>8324</td>
<td>-1.105</td>
<td>71%</td>
</tr>
<tr>
<td>AUDCAD</td>
<td>double</td>
<td>STD</td>
<td>FALSE</td>
<td>FALSE</td>
<td>41.58%</td>
<td>32.301%</td>
<td>34.1%</td>
<td>959</td>
<td>0.764</td>
<td>98%</td>
</tr>
<tr>
<td>AUDCAD</td>
<td>double</td>
<td>STD</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-4.95%</td>
<td>8.28%</td>
<td>21.7%</td>
<td>814</td>
<td>-0.017</td>
<td>98%</td>
</tr>
<tr>
<td>AUDCAD</td>
<td>double</td>
<td>STD</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-8.17%</td>
<td>6.912%</td>
<td>32.1%</td>
<td>1096</td>
<td>-0.082</td>
<td>98%</td>
</tr>
<tr>
<td>AUDCAD</td>
<td>double</td>
<td>ATR</td>
<td>FALSE</td>
<td>FALSE</td>
<td>35.42%</td>
<td>28.118%</td>
<td>67.7%</td>
<td>4368</td>
<td>0.704</td>
<td>96%</td>
</tr>
<tr>
<td>AUDCAD</td>
<td>double</td>
<td>ATR</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-21.32%</td>
<td>0.265%</td>
<td>28.5%</td>
<td>1467</td>
<td>-0.934</td>
<td>98%</td>
</tr>
<tr>
<td>AUDCAD</td>
<td>double</td>
<td>ATR</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-49.27%</td>
<td>0.509%</td>
<td>65.8%</td>
<td>8324</td>
<td>-0.931</td>
<td>97%</td>
</tr>
<tr>
<td>GBPCAD</td>
<td>average</td>
<td>STD</td>
<td>FALSE</td>
<td>FALSE</td>
<td>97.54%</td>
<td>49.78%</td>
<td>43.5%</td>
<td>1250</td>
<td>1.278</td>
<td>74%</td>
</tr>
<tr>
<td>GBPCAD</td>
<td>average</td>
<td>STD</td>
<td>TRUE</td>
<td>FALSE</td>
<td>109.54%</td>
<td>65.971%</td>
<td>19.7%</td>
<td>1203</td>
<td>1.661</td>
<td>75%</td>
</tr>
<tr>
<td>GBPCAD</td>
<td>average</td>
<td>STD</td>
<td>TRUE</td>
<td>TRUE</td>
<td>156%</td>
<td>78.098%</td>
<td>24.1%</td>
<td>1382</td>
<td>2.131</td>
<td>75%</td>
</tr>
<tr>
<td>GBPCAD</td>
<td>average</td>
<td>ATR</td>
<td>FALSE</td>
<td>FALSE</td>
<td>137.75%</td>
<td>49.858%</td>
<td>52.5%</td>
<td>5632</td>
<td>1.473</td>
<td>73%</td>
</tr>
<tr>
<td>GBPCAD</td>
<td>average</td>
<td>ATR</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-17.27%</td>
<td>2.41%%</td>
<td>30.2%</td>
<td>1913</td>
<td>-0.394</td>
<td>71%</td>
</tr>
<tr>
<td>GBPCAD</td>
<td>average</td>
<td>ATR</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-65.19%</td>
<td>0.226%</td>
<td>71.2%</td>
<td>8459</td>
<td>-0.971</td>
<td>73%</td>
</tr>
<tr>
<td>GBPCAD</td>
<td>double</td>
<td>STD</td>
<td>FALSE</td>
<td>FALSE</td>
<td>25.43%</td>
<td>24.555%</td>
<td>39.1%</td>
<td>1250</td>
<td>0.564</td>
<td>99%</td>
</tr>
<tr>
<td>GBPCAD</td>
<td>double</td>
<td>STD</td>
<td>TRUE</td>
<td>FALSE</td>
<td>28.3%</td>
<td>39.133%</td>
<td>12.2%</td>
<td>1203</td>
<td>0.865%</td>
<td>99%</td>
</tr>
<tr>
<td>GBPCAD</td>
<td>double</td>
<td>STD</td>
<td>TRUE</td>
<td>TRUE</td>
<td>48.86%</td>
<td>58.341</td>
<td>10.7%</td>
<td>1382</td>
<td>1.296</td>
<td>99%</td>
</tr>
<tr>
<td>GBPCAD</td>
<td>double</td>
<td>ATR</td>
<td>FALSE</td>
<td>FALSE</td>
<td>255.36%</td>
<td>69.083%</td>
<td>55.7%</td>
<td>5632</td>
<td>2.202</td>
<td>97%</td>
</tr>
<tr>
<td>GBPCAD</td>
<td>double</td>
<td>ATR</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-8.46%</td>
<td>3.877%</td>
<td>20.6%</td>
<td>1913</td>
<td>-0.276</td>
<td>98%</td>
</tr>
<tr>
<td>GBPCAD</td>
<td>double</td>
<td>ATR</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-45.97%</td>
<td>0.601%</td>
<td>55%</td>
<td>8459</td>
<td>-0.982</td>
<td>98%</td>
</tr>
<tr>
<td>USDJPY</td>
<td>average</td>
<td>STD</td>
<td>FALSE</td>
<td>FALSE</td>
<td>-1.72%</td>
<td>0.014%</td>
<td>2.1%</td>
<td>805</td>
<td>-1.603</td>
<td>71%</td>
</tr>
<tr>
<td>USDJPY</td>
<td>average</td>
<td>STD</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-0.22%</td>
<td>2.848%</td>
<td>0.6%</td>
<td>785</td>
<td>-0.373</td>
<td>72%</td>
</tr>
<tr>
<td>USDJPY</td>
<td>average</td>
<td>STD</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-0.42%</td>
<td>1.26%</td>
<td>0.7%</td>
<td>1135</td>
<td>-0.596</td>
<td>72%</td>
</tr>
<tr>
<td>USDJPY</td>
<td>average</td>
<td>ATR</td>
<td>FALSE</td>
<td>FALSE</td>
<td>-2.13%</td>
<td>0.062%</td>
<td>2.3%</td>
<td>4548</td>
<td>-1.347</td>
<td>72%</td>
</tr>
<tr>
<td>USDJPY</td>
<td>average</td>
<td>ATR</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-0.41%</td>
<td>0.020%</td>
<td>0.4%</td>
<td>1455</td>
<td>-1.242</td>
<td>72%</td>
</tr>
<tr>
<td>USDJPY</td>
<td>average</td>
<td>ATR</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-1.56%</td>
<td>0.001%</td>
<td>1.7%</td>
<td>8251</td>
<td>-2.611</td>
<td>71%</td>
</tr>
<tr>
<td>USDJPY</td>
<td>double</td>
<td>STD</td>
<td>FALSE</td>
<td>FALSE</td>
<td>-1.68%</td>
<td>0.006%</td>
<td>2%</td>
<td>805</td>
<td>-1.76%</td>
<td>98%</td>
</tr>
<tr>
<td>USDJPY</td>
<td>double</td>
<td>STD</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-0.22%</td>
<td>0.74%</td>
<td>0.4%</td>
<td>785</td>
<td>-0.65</td>
<td>97%</td>
</tr>
<tr>
<td>USDJPY</td>
<td>double</td>
<td>STD</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-0.37%</td>
<td>0.169%</td>
<td>0.5%</td>
<td>1135</td>
<td>-0.931</td>
<td>97%</td>
</tr>
<tr>
<td>USDJPY</td>
<td>double</td>
<td>ATR</td>
<td>FALSE</td>
<td>FALSE</td>
<td>-1.91%</td>
<td>0.057%</td>
<td>2.3%</td>
<td>4548</td>
<td>-1.355</td>
<td>94%</td>
</tr>
<tr>
<td>USDJPY</td>
<td>double</td>
<td>ATR</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-0.24%</td>
<td>0.17%</td>
<td>0.3%</td>
<td>1455</td>
<td>-1.081</td>
<td>98%</td>
</tr>
<tr>
<td>USDJPY</td>
<td>double</td>
<td>ATR</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-0.58%</td>
<td>0.512%</td>
<td>0.8%</td>
<td>8251</td>
<td>-1.342</td>
<td>96%</td>
</tr>
<tr>
<td>AUDJPY</td>
<td>average</td>
<td>STD</td>
<td>FALSE</td>
<td>FALSE</td>
<td>-2.51%</td>
<td>0.048%</td>
<td>3.4%</td>
<td>621</td>
<td>-1.314</td>
<td>67%</td>
</tr>
<tr>
<td>AUDJPY</td>
<td>average</td>
<td>STD</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-0.78%</td>
<td>1.384%</td>
<td>1.5%</td>
<td>573</td>
<td>-0.597</td>
<td>67%</td>
</tr>
<tr>
<td>AUDJPY</td>
<td>average</td>
<td>STD</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-1.55%</td>
<td>0.23%</td>
<td>2.3%</td>
<td>898</td>
<td>-1.013</td>
<td>67%</td>
</tr>
<tr>
<td>AUDJPY</td>
<td>average</td>
<td>ATR</td>
<td>FALSE</td>
<td>FALSE</td>
<td>-4.13%</td>
<td>0.032%</td>
<td>5%</td>
<td>3883</td>
<td>-1.45</td>
<td>71%</td>
</tr>
<tr>
<td>AUDJPY</td>
<td>average</td>
<td>ATR</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-0.78%</td>
<td>0.003%</td>
<td>0.9%</td>
<td>1303</td>
<td>-1.446</td>
<td>67%</td>
</tr>
<tr>
<td>AUDJPY</td>
<td>average</td>
<td>ATR</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-2.56%</td>
<td>0.001%</td>
<td>3%</td>
<td>8211</td>
<td>-2.624</td>
<td>70%</td>
</tr>
<tr>
<td>AUDJPY</td>
<td>double</td>
<td>STD</td>
<td>FALSE</td>
<td>FALSE</td>
<td>-2.05%</td>
<td>0.048%</td>
<td>2.9%</td>
<td>621</td>
<td>-1.287</td>
<td>97%</td>
</tr>
<tr>
<td>AUDJPY</td>
<td>double</td>
<td>STD</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-0.33%</td>
<td>2.78%</td>
<td>0.7%</td>
<td>573</td>
<td>-0.415</td>
<td>96%</td>
</tr>
<tr>
<td>AUDJPY</td>
<td>double</td>
<td>STD</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-0.71%</td>
<td>0.632%</td>
<td>1.1%</td>
<td>898</td>
<td>-0.8</td>
<td>96%</td>
</tr>
<tr>
<td>AUDJPY</td>
<td>double</td>
<td>ATR</td>
<td>FALSE</td>
<td>FALSE</td>
<td>-3.47%</td>
<td>0.057%</td>
<td>4.4%</td>
<td>3883</td>
<td>-1.334</td>
<td>93%</td>
</tr>
<tr>
<td>AUDJPY</td>
<td>double</td>
<td>ATR</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-0.41%</td>
<td>0.174%</td>
<td>0.6%</td>
<td>1303</td>
<td>-1.09</td>
<td>97%</td>
</tr>
<tr>
<td>AUDJPY</td>
<td>double</td>
<td>ATR</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-1%</td>
<td>0.263%</td>
<td>1.6%</td>
<td>8211</td>
<td>-1.495</td>
<td>97%</td>
</tr>
<tr>
<td>EURGBP</td>
<td>average</td>
<td>STD</td>
<td>FALSE</td>
<td>FALSE</td>
<td>193.48%</td>
<td>55.86%</td>
<td>59.3%</td>
<td>1342</td>
<td>1.777</td>
<td>69%</td>
</tr>
<tr>
<td>EURGBP</td>
<td>average</td>
<td>STD</td>
<td>TRUE</td>
<td>FALSE</td>
<td>184.33%</td>
<td>64.133%</td>
<td>53.2%</td>
<td>1325</td>
<td>1.84</td>
<td>70%</td>
</tr>
<tr>
<td>EURGBP</td>
<td>average</td>
<td>STD</td>
<td>TRUE</td>
<td>TRUE</td>
<td>236.89%</td>
<td>71.59%</td>
<td>50.1%</td>
<td>1451</td>
<td>2.168%</td>
<td>71%</td>
</tr>
<tr>
<td>EURGBP</td>
<td>average</td>
<td>ATR</td>
<td>FALSE</td>
<td>FALSE</td>
<td>-73.2%</td>
<td>14.02%</td>
<td>94.5%</td>
<td>4041</td>
<td>0.244</td>
<td>69%</td>
</tr>
<tr>
<td>EURGBP</td>
<td>average</td>
<td>ATR</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-66.65%</td>
<td>0%</td>
<td>67.4%</td>
<td>1120</td>
<td>-1.394</td>
<td>63%</td>
</tr>
<tr>
<td>EURGBP</td>
<td>average</td>
<td>ATR</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-91.09%</td>
<td>0.013%</td>
<td>91.2%</td>
<td>8343</td>
<td>-0.948</td>
<td>70%</td>
</tr>
<tr>
<td>EURGBP</td>
<td>double</td>
<td>STD</td>
<td>FALSE</td>
<td>FALSE</td>
<td>255.97%</td>
<td>71.420%</td>
<td>42.5%</td>
<td>1339</td>
<td>2.178</td>
<td>98%</td>
</tr>
<tr>
<td>EURGBP</td>
<td>double</td>
<td>STD</td>
<td>TRUE</td>
<td>FALSE</td>
<td>216.28%</td>
<td>93.866%</td>
<td>19.4%</td>
<td>1325</td>
<td>2.811</td>
<td>98%</td>
</tr>
<tr>
<td>EURGBP</td>
<td>double</td>
<td>STD</td>
<td>TRUE</td>
<td>TRUE</td>
<td>226.02%</td>
<td>94.772%</td>
<td>19.4%</td>
<td>1451</td>
<td>2.905</td>
<td>98%</td>
</tr>
<tr>
<td>EURGBP</td>
<td>double</td>
<td>ATR</td>
<td>FALSE</td>
<td>FALSE</td>
<td>-36.14%</td>
<td>20.836%</td>
<td>91.2%</td>
<td>4037</td>
<td>0.53</td>
<td>96%</td>
</tr>
<tr>
<td>EURGBP</td>
<td>double</td>
<td>ATR</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-48.93%</td>
<td>0%</td>
<td>49.4%</td>
<td>1120</td>
<td>-1.949</td>
<td>97%</td>
</tr>
<tr>
<td>EURGBP</td>
<td>double</td>
<td>ATR</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-73.37%</td>
<td>0.084%</td>
<td>73.4%</td>
<td>8343</td>
<td>-1.016</td>
<td>96%</td>
</tr>
<tr>
<td>GBPUSD</td>
<td>average</td>
<td>STD</td>
<td>FALSE</td>
<td>FALSE</td>
<td>-21.81%</td>
<td>13.698%</td>
<td>75.7%</td>
<td>814</td>
<td>0.223</td>
<td>72%</td>
</tr>
<tr>
<td>GBPUSD</td>
<td>average</td>
<td>STD</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-0.3%</td>
<td>15.694%</td>
<td>63.5%</td>
<td>783</td>
<td>0.301</td>
<td>74%</td>
</tr>
<tr>
<td>GBPUSD</td>
<td>average</td>
<td>STD</td>
<td>TRUE</td>
<td>TRUE</td>
<td>37.20%</td>
<td>27.093%</td>
<td>52.8%</td>
<td>1016</td>
<td>0.678</td>
<td>76%</td>
</tr>
<tr>
<td>GBPUSD</td>
<td>average</td>
<td>ATR</td>
<td>FALSE</td>
<td>FALSE</td>
<td>-60.85%</td>
<td>12.303%</td>
<td>91.1%</td>
<td>5090</td>
<td>0.169</td>
<td>73%</td>
</tr>
<tr>
<td>GBPUSD</td>
<td>average</td>
<td>ATR</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-39.26%</td>
<td>0.47%</td>
<td>47.2%</td>
<td>1651</td>
<td>-0.744</td>
<td>71%</td>
</tr>
<tr>
<td>GBPUSD</td>
<td>average</td>
<td>ATR</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-90.26%</td>
<td>0.002%</td>
<td>93.4%</td>
<td>8325</td>
<td>-1.192</td>
<td>70%</td>
</tr>
<tr>
<td>GBPUSD</td>
<td>double</td>
<td>STD</td>
<td>FALSE</td>
<td>FALSE</td>
<td>-2.78%</td>
<td>15.241%</td>
<td>55.2%</td>
<td>814</td>
<td>0.276%</td>
<td>98%</td>
</tr>
<tr>
<td>GBPUSD</td>
<td>double</td>
<td>STD</td>
<td>TRUE</td>
<td>FALSE</td>
<td>11.13%</td>
<td>17.60%</td>
<td>40%</td>
<td>785</td>
<td>0.355</td>
<td>98%</td>
</tr>
<tr>
<td>GBPUSD</td>
<td>double</td>
<td>STD</td>
<td>TRUE</td>
<td>TRUE</td>
<td>13.85%</td>
<td>18.86%</td>
<td>38.6%</td>
<td>1018</td>
<td>0.395</td>
<td>98%</td>
</tr>
<tr>
<td>GBPUSD</td>
<td>double</td>
<td>ATR</td>
<td>FALSE</td>
<td>FALSE</td>
<td>-15.88%</td>
<td>20.194%</td>
<td>89.3%</td>
<td>5090</td>
<td>0.472</td>
<td>93%</td>
</tr>
<tr>
<td>GBPUSD</td>
<td>double</td>
<td>ATR</td>
<td>TRUE</td>
<td>FALSE</td>
<td>-19.0%</td>
<td>2.947%</td>
<td>38.5%</td>
<td>1651</td>
<td>-0.378</td>
<td>97%</td>
</tr>
<tr>
<td>GBPUSD</td>
<td>double</td>
<td>ATR</td>
<td>TRUE</td>
<td>TRUE</td>
<td>-71.33%</td>
<td>0.1%</td>
<td>83.4%</td>
<td>8325</td>
<td>-1.181</td>
<td>98%</td>
</tr>
</tbody>
</table>
</div>
<h2 id="Post-analysis"><a href="#Post-analysis" class="headerlink" title="Post-analysis"></a>Post-analysis</h2><p>Across all scenarios and all foreign currency pairs, we can see that the strategy returns range from <font color='green'>230%</font> to <font color='red'>-90%</font>. The Sharpe ratios range from <font color='green'>2.2</font> to <font color='red'>-2.6</font>. It seems that the grid trading strategy is not very stable in terms of capturing profit. On the other hand, not surprising that the win rate is as high as 70% to 97%. These stats can clearly infer that our strategy can efficiently capture the profit when the price fluctuates. Sadly those trades that didn’t win actually cause us humongous losses.</p>
<p>Let’s do another round of analysis to look into the details of all the scenarios.</p>
<p>First, let’s look at the difference between using standard deviation and using <a target="_blank" rel="noopener" href="https://www.investopedia.com/terms/a/atr.asp">ATR (Average True Range)</a> indicator as our grid range. Apparently, the standard deviation is more outstanding in terms of predicting the proper range of price change.<br><img data-src="/2022/04/18/2022-04-20-forex-grid-trading-system/std_vs_atr.png" class="" width="400"></p>
<p style="font-size: 0.8em; text-align:center; color: grey;">
    <i>Ill. VI. STD v.s. ATR on Returns (%)</i>
</p>

<p>We don’t see much difference between using average allocation and double down allocation to control our position allocation on each bar.<br><img data-src="/2022/04/18/2022-04-20-forex-grid-trading-system/ave_vs_dou.png" class="" width="400"></p>
<p style="font-size: 0.8em; text-align:center; color: grey;">
    <i>Ill. VII. Average allocation v.s. double down allocation on Returns (%)</i>
</p>

<p>Lastly, let’s take a look at whether the stop-loss mechanism will help improve the quality of our trades. The strategy returns in all scenarios unanimously reduced a great certain percentage. In the meantime, the MDD (Max Drop Down) was also greatly reduced when applying the stop loss method. Unexpectedly, the stop loss and rescale method even deteriorate both the strategy return and MDD compared to the scenarios applying the stop-loss method.<br><img data-src="/2022/04/18/2022-04-20-forex-grid-trading-system/stoploss.png" class="" width="400"></p>
<p style="font-size: 0.8em; text-align:center; color: grey;">
    <i>Ill. VIII. Stoploss on Returns (%)</i>
</p>

<img data-src="/2022/04/18/2022-04-20-forex-grid-trading-system/stoploss_mdd.png" class="" width="400">
<p style="font-size: 0.8em; text-align:center; color: grey;">
    <i>Ill. VIII. Stoploss on MDD (%)</i>
</p>

<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>In short, the grid trading strategy has done what we ask it to capture all the profitable opportunities when the price fluctuates among our monitoring grid range. However, when the price moves in one direction in a short period of time, the potential cost could cost us the entire portfolio. The global economy and international politics are the origins of this sudden price change which we cannot predict. Unless we’re able to produce a stop loss method or hedge instrument to help us mitigate the risk and endure the sudden price movement, the grid trading strategy wouldn’t be able to help us consistently capture the <strong>risk-free</strong> profit.</p>
<p>To do that, here are a few topics that we can explore to further optimize our grid trading strategy:</p>
<ul>
<li>Better stop loss method</li>
<li>Using technical indicators to help identify and avoid the upward/downward trends.</li>
<li>Try to experiment with different foreign currency pairs, as each currency pair has its own characteristic. Some possess high volatility, and some are relatively stable.</li>
</ul>
<p>That’ll be all for this post. Cheers.</p>
<hr>
<h1 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h1><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://quantpedia.com/a-primer-on-grid-trading-strategy/">A primer on grid trading strategy</a></li>
<li><a target="_blank" rel="noopener" href="https://quantpedia.com/whats-the-relation-between-grid-trading-and-delta-hedging/">What’s the relation between grid trading and delta hedging</a></li>
<li><a target="_blank" rel="noopener" href="http://blog.sina.com.cn/s/blog_69e73f710100kd6x.html">Fundamental of grid trading strategy</a></li>
<li><a target="_blank" rel="noopener" href="https://forexwithanedge.com/grid-trading/">Grid trading</a></li>
<li><a target="_blank" rel="noopener" href="https://baijiahao.baidu.com/s?id=1703235910517684547&amp;wfr=spider&amp;for=pc">How to pick the right currency pair to trade as a Forex beginners?</a></li>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=fHPPnZcsDEo">Grid trading bot Part 2</a></li>
</ul>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">from datetime import datetime</span><br><span class="line">import re</span><br><span class="line">from enum import Enum</span><br><span class="line"></span><br><span class="line">class ReferenceType(Enum):</span><br><span class="line">    AVERAGE &#x3D; 1</span><br><span class="line">    PREVIOUS_CLOSE &#x3D; 2</span><br><span class="line"></span><br><span class="line">class VolatilityType(Enum):</span><br><span class="line">    STANDARD_DEVIATION &#x3D; 1</span><br><span class="line">    HIGH_LOW &#x3D; 2    # This trigger very little orders, ineffective.</span><br><span class="line">    ATR &#x3D; 3</span><br><span class="line"></span><br><span class="line">class PositionAmountType(Enum):</span><br><span class="line">    AVERAGE &#x3D; 1</span><br><span class="line">    INCREMENTAL &#x3D; 2</span><br><span class="line">    DOUBLEUP &#x3D; 3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class FXMomentumAlgorithm(QCAlgorithm):</span><br><span class="line">    def Initialize(self):</span><br><span class="line">        self.SetStartDate(2020, 12, 28)</span><br><span class="line">        # self.SetStartDate(2017, 12, 28)</span><br><span class="line">        self.SetEndDate(datetime.now())</span><br><span class="line">        self.SetCash(100000)</span><br><span class="line">        self.resolution &#x3D; Resolution.Minute</span><br><span class="line">        self._grid_number &#x3D; 10</span><br><span class="line">        self._leverage_ratio &#x3D; 50</span><br><span class="line">        self._reference_price &#x3D; None</span><br><span class="line">        self._std &#x3D; None</span><br><span class="line">        self._stop_loss &#x3D; None</span><br><span class="line">        self._cash_preserve_ratio &#x3D; 0.99</span><br><span class="line">        self._cash_per_position &#x3D; None</span><br><span class="line"></span><br><span class="line">        self.IS_READY &#x3D; False</span><br><span class="line">        self.REFERENCE_PRICE_METHOD &#x3D; ReferenceType.PREVIOUS_CLOSE</span><br><span class="line">        self.POSITION_AMOUNT_METHOD &#x3D; PositionAmountType.AVERAGE</span><br><span class="line">        self.VOLATILITY_METHOD &#x3D; VolatilityType.STANDARD_DEVIATION</span><br><span class="line">        self.VOLATILITY_MULTIPLIER &#x3D; 2</span><br><span class="line">        self.STOP_LOSS_MODE &#x3D; False</span><br><span class="line">        self.STOP_LOSS_RESCALE &#x3D; False</span><br><span class="line">        self.STOP_LOSS_MULTIPLIER &#x3D; 1.2 # 10% more on upper side and 10% less on lower side</span><br><span class="line"></span><br><span class="line">        # self.pair &#x3D; &#39;GBPCHF&#39;</span><br><span class="line">        # self.pair &#x3D; &#39;AUDCAD&#39;</span><br><span class="line">        # self.pair &#x3D; &#39;GBPCAD&#39;</span><br><span class="line">        # self.pair &#x3D; &#39;USDJPY&#39;</span><br><span class="line">        # self.pair &#x3D; &#39;AUDJPY&#39;</span><br><span class="line">        self.pair &#x3D; &#39;EURGBP&#39;</span><br><span class="line">        # self.pair &#x3D; &#39;GBPUSD&#39;</span><br><span class="line"></span><br><span class="line">        self.forex &#x3D; self.AddForex(</span><br><span class="line">            self.pair,</span><br><span class="line">            self.resolution,</span><br><span class="line">            Market.Oanda,</span><br><span class="line">            True,</span><br><span class="line">            self._leverage_ratio</span><br><span class="line">        )</span><br><span class="line">        # self.Debug(f&#39;Our Leverage: &#123;self.forex.MarginModel.GetLeverage(self.forex)&#125;&#39;)</span><br><span class="line"></span><br><span class="line">        ################################################</span><br><span class="line">        # Adding Schedule event</span><br><span class="line">        self.Schedule.On(</span><br><span class="line">            self.DateRules.MonthStart(self.pair),</span><br><span class="line">            self.TimeRules.AfterMarketOpen(self.pair, 0),</span><br><span class="line">            self.openMarket</span><br><span class="line">        )</span><br><span class="line">        self.Schedule.On(</span><br><span class="line">            self.DateRules.MonthEnd(self.pair),</span><br><span class="line">            self.TimeRules.BeforeMarketClose(self.pair, 5),</span><br><span class="line">            self.closeMarket</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    def OnData(self, data):</span><br><span class="line">        if not self.IS_READY or self.pair not in data:</span><br><span class="line">            return</span><br><span class="line"></span><br><span class="line">        if not self.STOP_LOSS_MODE:</span><br><span class="line">            return</span><br><span class="line"></span><br><span class="line">        # Stop loss</span><br><span class="line">        if data[self.pair].Close &lt; (self._reference_price - self._stop_loss) or data[self.pair].Close &gt; (self._reference_price + self._stop_loss):</span><br><span class="line">            # self.Debug(f&#39;&#123;self.Time&#125;: Break out and clean the open orders&#39;)</span><br><span class="line">            # Liquidate all positions and close all open orders</span><br><span class="line">            self.Liquidate(self.pair)</span><br><span class="line">            if self.STOP_LOSS_RESCALE:</span><br><span class="line">                self.openMarket()</span><br><span class="line"></span><br><span class="line">    def setParameters(self):</span><br><span class="line">        history &#x3D; self.History([self.pair], 93, Resolution.Daily)</span><br><span class="line">        history &#x3D; history.droplevel(0)</span><br><span class="line"></span><br><span class="line">        # Set up reference price</span><br><span class="line">        if self.REFERENCE_PRICE_METHOD &#x3D;&#x3D; ReferenceType.PREVIOUS_CLOSE:</span><br><span class="line">            # Get close of previous day</span><br><span class="line">            self._reference_price &#x3D; self.History(</span><br><span class="line">                [self.pair],</span><br><span class="line">                2880,</span><br><span class="line">                Resolution.Minute</span><br><span class="line">            ).droplevel(0).close[-1]</span><br><span class="line">        elif self.REFERENCE_PRICE_METHOD &#x3D;&#x3D; ReferenceType.AVERAGE:</span><br><span class="line">            # Daily moving average</span><br><span class="line">            self.Debug(&#39;Average mean&#39;)</span><br><span class="line">            self._reference_price &#x3D; history.close[-20:].mean()</span><br><span class="line"></span><br><span class="line">        # Cash amount per position</span><br><span class="line">        if self.POSITION_AMOUNT_METHOD &#x3D;&#x3D; PositionAmountType.AVERAGE:</span><br><span class="line">            # Leveraged Equal weighted</span><br><span class="line">            self._cash_per_position &#x3D; (self.Portfolio.MarginRemaining * self._leverage_ratio * self._cash_preserve_ratio) &#x2F; (self._grid_number * 2)</span><br><span class="line">        elif self.POSITION_AMOUNT_METHOD &#x3D;&#x3D; PositionAmountType.INCREMENTAL:</span><br><span class="line">            # Leveraged incremental weighted</span><br><span class="line">            self._cash_per_position &#x3D; (self.Portfolio.MarginRemaining * self._leverage_ratio * self._cash_preserve_ratio) &#x2F; (sum(range(1, self._grid_number+1)) * 2)</span><br><span class="line">        elif self.POSITION_AMOUNT_METHOD &#x3D;&#x3D; PositionAmountType.DOUBLEUP:</span><br><span class="line">            # Leveraged double up weighted</span><br><span class="line">            self._cash_per_position &#x3D; (self.Portfolio.MarginRemaining * self._leverage_ratio * self._cash_preserve_ratio) &#x2F; ((2**self._grid_number - 1) * 2)</span><br><span class="line"></span><br><span class="line">        # Get volatility of previous day</span><br><span class="line">        if self.VOLATILITY_METHOD &#x3D;&#x3D; VolatilityType.STANDARD_DEVIATION:</span><br><span class="line">            # The 2 * Standardization &#x3D; 95%</span><br><span class="line">            self._std &#x3D; history.close.std() * self.VOLATILITY_MULTIPLIER</span><br><span class="line">        elif self.VOLATILITY_METHOD &#x3D;&#x3D; VolatilityType.HIGH_LOW:</span><br><span class="line">            # The high and low of the previous market open day</span><br><span class="line">            self._std &#x3D; abs(history.high.max() - history.low.min())</span><br><span class="line">        elif self.VOLATILITY_METHOD &#x3D;&#x3D; VolatilityType.ATR:</span><br><span class="line">            # ATR</span><br><span class="line">            self._std &#x3D; ta.ATR(history.high, history.low, history.close, timeperiod&#x3D;60)[-1]</span><br><span class="line"></span><br><span class="line">        self._stop_loss &#x3D; self._std * self.STOP_LOSS_MULTIPLIER</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    def openMarket(self):</span><br><span class="line">        # self.Debug(f&#39;&#123;self.Time&#125; Market open. Order number (&#123;len(self.Transactions.GetOpenOrders(self.pair))&#125;)&#39;)</span><br><span class="line">        self.setParameters()</span><br><span class="line"></span><br><span class="line">        # Cancel all open orders before creating new orders</span><br><span class="line">        self.Liquidate(self.pair)</span><br><span class="line"></span><br><span class="line">        # Set up the grid limit order</span><br><span class="line"></span><br><span class="line">        for i in range(1, self._grid_number + 1):</span><br><span class="line">            qty &#x3D; int(self._cash_per_position * self.get_qty_multiplier(i) &#x2F; (self._reference_price - self._std &#x2F; self._grid_number * i))</span><br><span class="line">            order &#x3D; self.LimitOrder(</span><br><span class="line">                self.pair,</span><br><span class="line">                qty,</span><br><span class="line">                round(self._reference_price - self._std &#x2F; self._grid_number * i, 5),</span><br><span class="line">                f&#39;Long&#123;i&#125;&#39;</span><br><span class="line">            )</span><br><span class="line">            qty &#x3D; int(self._cash_per_position * self.get_qty_multiplier(i) &#x2F; (self._reference_price + self._std &#x2F; self._grid_number * i))</span><br><span class="line">            order &#x3D; self.LimitOrder(</span><br><span class="line">                self.pair,</span><br><span class="line">                -qty,</span><br><span class="line">                round(self._reference_price + self._std &#x2F; self._grid_number * i, 5),</span><br><span class="line">                f&#39;Short&#123;i&#125;&#39;</span><br><span class="line">            )</span><br><span class="line">        self.IS_READY &#x3D; True</span><br><span class="line"></span><br><span class="line">    def closeMarket(self):</span><br><span class="line">        # self.Debug(f&#39;&#123;self.Time&#125; Market close&#39;)</span><br><span class="line"></span><br><span class="line">        # Liquidate all positions by the end of the day</span><br><span class="line">        self.Liquidate(self.pair)</span><br><span class="line"></span><br><span class="line">        # self.Debug(f&#39;&#123;self.Time&#125; Market close. Order number (&#123;len(self.Transactions.GetOpenOrders(self.pair))&#125;)&#39;)</span><br><span class="line"></span><br><span class="line">    def OnOrderEvent(self, orderEvent):</span><br><span class="line">        order &#x3D; self.Transactions.GetOrderById(orderEvent.OrderId)</span><br><span class="line">        if orderEvent.Status &#x3D;&#x3D; OrderStatus.Filled:</span><br><span class="line">            # self.Debug(</span><br><span class="line">            #     &quot;&#123;0&#125;: &#123;1&#125; (&#123;2&#125;)&quot;.format(</span><br><span class="line">            #         self.Time,</span><br><span class="line">            #         orderEvent,</span><br><span class="line">            #         order.Tag</span><br><span class="line">            #     )</span><br><span class="line">            # )</span><br><span class="line"></span><br><span class="line">            match &#x3D; re.match(r&#39;(.*)(\d+)(.*)$&#39;, order.Tag)</span><br><span class="line"></span><br><span class="line">            if not match:</span><br><span class="line">                return</span><br><span class="line"></span><br><span class="line">            if match.group(1) &#x3D;&#x3D; &#39;Long&#39;:</span><br><span class="line">                i &#x3D; int(match.group(2))</span><br><span class="line">                if match.group(3) &#x3D;&#x3D; &#39;-Liquidate&#39;:</span><br><span class="line">                    qty &#x3D; int(self._cash_per_position * self.get_qty_multiplier(i) &#x2F; (self._reference_price - self._std &#x2F; self._grid_number * i))</span><br><span class="line">                    self.LimitOrder(</span><br><span class="line">                        self.pair,</span><br><span class="line">                        qty,</span><br><span class="line">                        round(self._reference_price - self._std &#x2F; self._grid_number * i, 5),</span><br><span class="line">                        f&#39;Long&#123;match.group(2)&#125;&#39;</span><br><span class="line">                    )</span><br><span class="line">                else:</span><br><span class="line">                    if (i - 1) &#x3D;&#x3D; 0:</span><br><span class="line">                        self.LimitOrder(</span><br><span class="line">                            self.pair,</span><br><span class="line">                            -abs(order.Quantity),</span><br><span class="line">                            round(self._reference_price, 5),</span><br><span class="line">                            f&#39;Long&#123;match.group(2)&#125;-Liquidate&#39;</span><br><span class="line">                        )</span><br><span class="line">                    elif i &gt; 1:</span><br><span class="line">                        self.LimitOrder(</span><br><span class="line">                            self.pair,</span><br><span class="line">                            -abs(order.Quantity),</span><br><span class="line">                            round(self._reference_price - self._std &#x2F; self._grid_number * (i - 1), 5),</span><br><span class="line">                            f&#39;Long&#123;match.group(2)&#125;-Liquidate&#39;</span><br><span class="line">                        )</span><br><span class="line">            elif match.group(1) &#x3D;&#x3D; &#39;Short&#39;:</span><br><span class="line">                i &#x3D; int(match.group(2))</span><br><span class="line">                if match.group(3) &#x3D;&#x3D; &#39;-Liquidate&#39;:</span><br><span class="line">                    qty &#x3D; int(self._cash_per_position * self.get_qty_multiplier(i) &#x2F; (self._reference_price + self._std &#x2F; self._grid_number * i))</span><br><span class="line">                    self.LimitOrder(</span><br><span class="line">                        self.pair,</span><br><span class="line">                        -qty,</span><br><span class="line">                        round(self._reference_price + self._std &#x2F; self._grid_number * i, 5),</span><br><span class="line">                        f&#39;Short&#123;match.group(2)&#125;&#39;</span><br><span class="line">                    )</span><br><span class="line">                    openOrders &#x3D; self.Transactions.GetOpenOrders(self.pair)</span><br><span class="line">                    for order in openOrders:</span><br><span class="line">                        if order.Tag in [f&#39;Short&#123;match.group(2)&#125;-Liquidate&#39;, f&#39;Short&#123;match.group(2)&#125;-Stoploss&#39;]:</span><br><span class="line">                            self.Transactions.CancelOrder(order.Id)</span><br><span class="line">                else:</span><br><span class="line">                    if (i - 1) &#x3D;&#x3D; 0:</span><br><span class="line">                        self.LimitOrder(</span><br><span class="line">                            self.pair,</span><br><span class="line">                            abs(order.Quantity),</span><br><span class="line">                            round(self._reference_price, 5),</span><br><span class="line">                            f&#39;Short&#123;match.group(2)&#125;-Liquidate&#39;</span><br><span class="line">                        )</span><br><span class="line">                    else:</span><br><span class="line">                        self.LimitOrder(</span><br><span class="line">                            self.pair,</span><br><span class="line">                            abs(order.Quantity),</span><br><span class="line">                            round(self._reference_price + self._std &#x2F; self._grid_number * (i - 1), 5),</span><br><span class="line">                            f&#39;Short&#123;match.group(2)&#125;-Liquidate&#39;</span><br><span class="line">                        )</span><br><span class="line">        self.IS_READY &#x3D; False</span><br><span class="line"></span><br><span class="line">    def get_qty_multiplier(self, grid_number):</span><br><span class="line">        if self.POSITION_AMOUNT_METHOD &#x3D;&#x3D; PositionAmountType.AVERAGE:</span><br><span class="line">            # Even weighted</span><br><span class="line">            return 1</span><br><span class="line">        elif self.POSITION_AMOUNT_METHOD &#x3D;&#x3D; PositionAmountType.INCREMENTAL:</span><br><span class="line">            # Incremental</span><br><span class="line">            return grid_number</span><br><span class="line">        elif self.POSITION_AMOUNT_METHOD &#x3D;&#x3D; PositionAmountType.DOUBLEUP:</span><br><span class="line">            # Double up weighted</span><br><span class="line">            if not isinstance(grid_number, (int)):</span><br><span class="line">                grid_number &#x3D; int(grid_number)</span><br><span class="line">            return 2**(grid_number - 1)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
    </div>
    
      
        <div>
    <p style="color: grey; font-family: Georgia; font-size: 1.2em;"><i>
        Disclaimer: Nothing herein is financial advice or even a recommendation to trade real money. Many platforms exist for simulated trading (paper trading) which can be used for building and developing the strategies discussed. Please use common sense and consult a professional before trading or investing your hard-earned money.
    </i></p>
</div>




      
    

    
    
    
        <div class="reward-container">
  <div>Enjoy reading? Some donations would motivate me to produce more quality content</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    Tip
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.png" alt="Michael Hsia WeChat Pay">
        <p>WeChat Pay</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.png" alt="Michael Hsia Alipay">
        <p>Alipay</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/stripe.png" alt="Michael Hsia Stripe">
        <p>Stripe</p>
      </div>

  </div>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Backtesting/" rel="tag"># Backtesting</a>
              <a href="/tags/Grid-trading/" rel="tag"># Grid trading</a>
              <a href="/tags/Forex/" rel="tag"># Forex</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/03/18/2022-03-22-supertrend-indicator/" rel="prev" title="Yes or No? Adopting the Supertrend indicator in your trading strategies?">
      <i class="fa fa-chevron-left"></i> Yes or No? Adopting the Supertrend indicator in your trading strategies?
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/06/10/2022-06-10-adcanced-optimization/" rel="next" title="【ML algo trading】 V - Raise your trading win rate through feature engineering">
      【ML algo trading】 V - Raise your trading win rate through feature engineering <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Talking"><span class="nav-number">1.</span> <span class="nav-text">Talking</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Forex-FX-and-Forex-trading"><span class="nav-number">1.1.</span> <span class="nav-text">Forex (FX) and Forex trading</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Forex-grid-trading-strategy"><span class="nav-number">1.2.</span> <span class="nav-text">Forex grid trading strategy</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Doing"><span class="nav-number">2.</span> <span class="nav-text">Doing</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Strategy-implementation"><span class="nav-number">2.1.</span> <span class="nav-text">Strategy implementation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Strategy-setups-for-our-backtests"><span class="nav-number">2.1.1.</span> <span class="nav-text">Strategy setups for our backtests</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Platform"><span class="nav-number">2.1.2.</span> <span class="nav-text">Platform</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Universe"><span class="nav-number">2.1.3.</span> <span class="nav-text">Universe</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Backtest-time-frame"><span class="nav-number">2.1.4.</span> <span class="nav-text">Backtest time frame</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Signal-generation"><span class="nav-number">2.1.5.</span> <span class="nav-text">Signal generation</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Backtest-result"><span class="nav-number">2.2.</span> <span class="nav-text">Backtest result</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Post-analysis"><span class="nav-number">2.3.</span> <span class="nav-text">Post-analysis</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Conclusion"><span class="nav-number">3.</span> <span class="nav-text">Conclusion</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Appendix"><span class="nav-number">4.</span> <span class="nav-text">Appendix</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#References"><span class="nav-number">4.1.</span> <span class="nav-text">References</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Code"><span class="nav-number">4.2.</span> <span class="nav-text">Code</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Michael Hsia</p>
  <div class="site-description" itemprop="description">Free your potential with learning for the rest of your life</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">59</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">21</span>
        <span class="site-state-item-name">tags</span></a>
      </div>

  </nav>
    

  <div class="">

    <div class="">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>

</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Michael Hsia</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/valine@1/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'xqc1TRzBeSqWMcMIO6i05hrV-MdYXbMMI',
      appKey     : '8y8oPqyB7YE9KwpM33MRijdR',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : 'https://xqc1trzb.api.lncldglobal.com'
    });
  }, window.Valine);
});
</script>

</body>
</html>
